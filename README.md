# M3U8 Web Downloader & Transcoder

ä¸€ä¸ªåŸºäº Web æŠ€æœ¯çš„ç°ä»£åŒ– M3U8 è§†é¢‘ä¸‹è½½ä¸è½¬ç å·¥å…·ã€‚æ— éœ€å®‰è£…ä»»ä½•å®¢æˆ·ç«¯ï¼Œçº¯æµè§ˆå™¨è¿è¡Œï¼Œæ”¯æŒå®æ—¶é¢„è§ˆã€å¯è§†åŒ–åˆ‡ç‰‡é€‰æ‹©ã€å¤šçº¿ç¨‹ä¸‹è½½ä»¥åŠæœ¬åœ° FFmpeg è½¬ç ã€‚

![License](https://img.shields.io/badge/license-MIT-blue.svg) ![Vue 3](https://img.shields.io/badge/vue-3.x-green.svg) ![FFmpeg.wasm](https://img.shields.io/badge/ffmpeg.wasm-0.11-orange.svg)

## âœ¨ æ ¸å¿ƒç‰¹æ€§

*   **å¯è§†åŒ–æ—¶é—´è½´**ï¼šç›´è§‚å±•ç¤ºè§†é¢‘åˆ‡ç‰‡ï¼Œæ”¯æŒæ‹–æ‹½æ¡†é€‰ã€æ™ºèƒ½é€‰æ‹©ï¼ˆå‰30ç§’ã€å‰5åˆ†é’Ÿç­‰ï¼‰ã€‚
*   **åŒå¼•æ“è½¬ç ç­–ç•¥**ï¼š
    *   **Mix Mode (MP4)**: ä½¿ç”¨ `FFmpeg.wasm` åœ¨æµè§ˆå™¨ç«¯è¿›è¡Œæ— æŸæ··æµï¼ˆRemuxï¼‰ï¼Œå°† TS åˆ‡ç‰‡åˆå¹¶ä¸ºæ ‡å‡† MP4ã€‚
    *   **Raw Mode (TS)**: å¿«é€Ÿåˆå¹¶åŸå§‹ TS æµï¼Œæ”¯æŒ fMP4 æ ¼å¼ï¼ˆè‡ªåŠ¨å¤„ç† Init Segmentï¼‰ã€‚
*   **fMP4 å®Œæ•´æ”¯æŒ**ï¼šè‡ªåŠ¨æ•è·å¹¶å¤„ç† HLS ä¸­çš„ `init` åˆ†æ®µï¼Œè§£å†³ fMP4 æ ¼å¼ä¸‹è½½åæ— æ³•æ’­æ”¾æˆ–åˆ†è¾¨ç‡ä¸¢å¤±çš„é—®é¢˜ã€‚
*   **éšç§å®‰å…¨**ï¼šæ ¸å¿ƒé€»è¾‘å…¨åœ¨æœ¬åœ°æµè§ˆå™¨è¿è¡Œï¼Œè§†é¢‘æ•°æ®ä¸ç»è¿‡ä»»ä½•ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ï¼ˆé™¤ä¸ºäº†è§£å†³ CORS é—®é¢˜çš„ Cloudflare Worker ä»£ç†ï¼‰ã€‚
*   **AES-128 è§£å¯†**ï¼šæ”¯æŒæ ‡å‡† HLS AES-128 åŠ å¯†æµçš„è‡ªåŠ¨è§£å¯†ã€‚
*   **ç²¾å‡†åŒæ­¥**ï¼šåŸºäºåºåˆ—å·ï¼ˆSequence Numberï¼‰çš„ç²¾å‡†çŠ¶æ€åŒæ­¥ï¼Œæ‹’ç»â€œå‡ä¸‹è½½â€ã€‚
*   **é«˜å¹¶å‘ä¸‹è½½**ï¼šå†…ç½®åŠ¨æ€å¹¶å‘æ§åˆ¶ï¼ˆé»˜è®¤ 6 çº¿ç¨‹ï¼‰ï¼Œæ”¯æŒæ–­ç‚¹é‡è¯•ã€‚
*   **åå°ä»»åŠ¡é˜Ÿåˆ—**ï¼šæ”¯æŒå°†ä¸‹è½½ä»»åŠ¡åŠ å…¥åå°é˜Ÿåˆ—ï¼Œå®ç°å¤šä»»åŠ¡è‡ªåŠ¨è°ƒåº¦ä¸ç®¡ç†ï¼Œäº’ä¸å¹²æ‰°ï¼Œæ”¯æŒâ€œè¾¹çœ‹è¾¹ä¸‹â€çš„å·¥ä½œæµã€‚
*   **ç°ä»£åŒ– UI**ï¼šåŸºäº Glassmorphismï¼ˆæ¯›ç»ç’ƒï¼‰è®¾è®¡é£æ ¼ï¼Œæ”¯æŒå¤šä¸»é¢˜åˆ‡æ¢ï¼ˆé»˜è®¤ã€é«˜å¯¹æ¯”åº¦ã€æµ·æ´‹ã€æš–è‰²ï¼‰ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

*   **Frontend**: Vue 3 (Composition API), Hls.js
*   **Transcoding**: FFmpeg.wasm (v0.11 Single Threaded), Web Crypto API (AES Decryption)
*   **Backend / Proxy**: Cloudflare Workers (ç”¨äºè§£å†³è·¨åŸŸè¯·æ±‚é™åˆ¶)
*   **Styling**: Native CSS Variables, Glassmorphism UI

## ğŸ“– ä½¿ç”¨è¯´æ˜

1.  **è¾“å…¥æº**ï¼š
    *   åœ¨è¾“å…¥æ¡†ç²˜è´´ `.m3u8` é“¾æ¥ã€‚
    *   æˆ–ç‚¹å‡»æ–‡ä»¶å¤¹å›¾æ ‡ä¸Šä¼ æœ¬åœ° `.m3u8` / `.txt` æ–‡ä»¶ã€‚
2.  **è§£æä¸é¢„è§ˆ**ï¼š
    *   ç‚¹å‡»â€œè§£æé“¾æ¥â€ã€‚
    *   ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†æ Master Playlistï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¸åŒçš„åˆ†è¾¨ç‡æˆ–éŸ³è½¨ã€‚
    *   è§†é¢‘æ’­æ”¾å™¨ä¼šè‡ªåŠ¨é¢„åŠ è½½ï¼Œæ‚¨å¯ä»¥é¢„è§ˆè§†é¢‘å†…å®¹ã€‚
3.  **é€‰æ‹©åˆ‡ç‰‡**ï¼š
    *   **æ‰‹åŠ¨æ¡†é€‰**ï¼šåœ¨ä¸‹æ–¹æ—¶é—´è½´ä¸ŠæŒ‰ä½é¼ æ ‡å·¦é”®æ‹–æ‹½ã€‚
    *   **æ™ºèƒ½é€‰æ‹©**ï¼šç‚¹å‡»â€œå‰äº”åˆ†é’Ÿâ€ã€â€œå‰30ç§’â€ç­‰å¿«æ·æŒ‰é’®ã€‚
    *   **ç‚¹é€‰**ï¼šåœ¨ç½‘æ ¼è§†å›¾ä¸­ç‚¹å‡»å•ä¸ªåˆ‡ç‰‡ã€‚
4.  **ä¸‹è½½**ï¼š
    *   **ç›´æ¥ä¸‹è½½**ï¼šç‚¹å‡»â€œå¼€å§‹ä¸‹è½½â€ï¼Œç³»ç»Ÿä¼šåœ¨å½“å‰ç•Œé¢å¯åŠ¨å¤šçº¿ç¨‹ä¸‹è½½ï¼Œç»¿è‰²ä»£è¡¨å·²ä¸‹è½½å®Œæˆã€‚
    *   **åå°é˜Ÿåˆ—**ï¼šç‚¹å‡»â€œåŠ å…¥é˜Ÿåˆ—â€ï¼Œä»»åŠ¡å°†ç§»è‡³åå°è¿è¡Œã€‚æ‚¨å¯ä»¥ç»§ç»­è§£æå…¶ä»–é“¾æ¥ï¼Œäº’ä¸å½±å“ã€‚åœ¨é¡µé¢åº•éƒ¨çš„â€œåå°ä»»åŠ¡é˜Ÿåˆ—â€é¢æ¿ä¸­å¯æŸ¥çœ‹è¿›åº¦ã€‚
5.  **å¯¼å‡º**ï¼š
    *   **å½“å‰ä»»åŠ¡**ï¼šä¸‹è½½å®Œæˆåï¼Œç‚¹å‡»ä¸Šæ–¹â€œä¿å­˜æ–‡ä»¶â€ã€‚
    *   **é˜Ÿåˆ—ä»»åŠ¡**ï¼šåœ¨ä»»åŠ¡é˜Ÿåˆ—é¢æ¿ä¸­ï¼Œç‚¹å‡»ä»»åŠ¡å³ä¾§çš„ **MP4** æˆ– **TS** æŒ‰é’®ç›´æ¥å¯¼å‡ºã€‚
    *   é€‰æ‹© **Raw (TS)** å¯¼å‡ºåŸå§‹ä¼ è¾“æµï¼ˆé€‚åˆå­˜æ¡£ï¼‰ã€‚
    *   é€‰æ‹© **Mix (MP4)** å¯¼å‡ºé€šç”¨åª’ä½“æ–‡ä»¶ï¼ˆé€‚åˆæ’­æ”¾ï¼‰ã€‚

## ğŸš€ éƒ¨ç½²æ•™ç¨‹ (Cloudflare Pages)

æœ¬é¡¹ç›®ä¸“ä¸º Cloudflare Pages è®¾è®¡ï¼ŒåŒ…å« `_worker.js` ä»£ç†è„šæœ¬ã€‚

### å‰ç½®è¦æ±‚
*   Node.js & npm
*   Cloudflare è´¦å·

### æœ¬åœ°å¼€å‘
```bash
# å®‰è£…ä¾èµ– (å¦‚æœä½¿ç”¨ wrangler)
npm install -g wrangler

# å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨ (åŒ…å« Worker ä»£ç†æ”¯æŒ)
npx wrangler pages dev .
```
è®¿é—® `http://localhost:8788` å³å¯ä½¿ç”¨ã€‚

### éƒ¨ç½²åˆ° Cloudflare Pages
1.  ç™»å½• Cloudflare Dashboardã€‚
2.  è¿›å…¥ **Workers & Pages** -> **Create Application** -> **Pages** -> **Upload assets**ã€‚
3.  ä¸Šä¼ æœ¬é¡¹ç›®æ‰€åœ¨æ–‡ä»¶å¤¹ï¼ˆåŒ…å« `index.html` å’Œ `_worker.js`ï¼‰ã€‚
4.  éƒ¨ç½²å®Œæˆåå³å¯è®¿é—®ã€‚

**æ³¨æ„**ï¼š`_worker.js` æ˜¯å¿…éœ€çš„ï¼Œå®ƒå……å½“ CORS ä»£ç†ã€‚å¦‚æœéƒ¨ç½²åˆ°å…¶ä»–ç¯å¢ƒï¼ˆå¦‚ Nginxï¼‰ï¼Œä½ éœ€è¦è‡ªè¡Œé…ç½®åå‘ä»£ç†æ¥è§£å†³è·¨åŸŸé—®é¢˜ã€‚

## âš ï¸ å¸¸è§é—®é¢˜
*   **ä¸ºä»€ä¹ˆ #1 åˆ†æ®µæ²¡å˜è‰²ï¼Ÿ**
    *   è¿™æ˜¯å› ä¸ºæ’­æ”¾å™¨åŠ è½½è¿‡å¿«å¯¼è‡´çš„ç«æ€æ¡ä»¶ï¼Œæœ€æ–°ç‰ˆæœ¬å·²ä¿®å¤æ­¤é—®é¢˜ï¼ˆé€šè¿‡è°ƒæ•´åˆå§‹åŒ–é¡ºåºï¼‰ã€‚
*   **å¯¼å‡º MP4 å¤±è´¥ï¼Ÿ**
    *   è¯·ç¡®ä¿å†…å­˜å……è¶³ã€‚ç”±äºæµè§ˆå™¨é™åˆ¶ï¼Œè¿‡å¤§çš„è§†é¢‘ï¼ˆ>1GBï¼‰å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚å»ºè®®åˆ†æ®µä¸‹è½½å¯¼å‡ºã€‚

---
*Created by Trae AI Assistant*
